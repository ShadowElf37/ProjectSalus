<!DOCTYPE html>
<html>
    <head>
        <title>Home</title>
        {{css('darkbb.css')}}
        {{js('lib.js')}}
        {{js('asyncpost.js')}}
        {{js('dynamicbb.js')}}
    </head>
    <body>
        <div class="navbar">
            <div class="navbar-header"><a href="#">Project Salus</a></div>
            <div class="reboot-controls">
                [[reboot_controls]]
            </div>
            <ul class="navbar-items">
                [[navbar]]
            </ul>
        </div>

        <center>
            <div class="page-container">
                <div style="text-align: left; margin-left: 50px; font-size: 150%">
                    <!--<h1 style="float: right; display: block; margin-top: 10px; margin-right: 70px">{{getDate()}}</h1>
                    <h1 style="margin-top: 20px; margin-bottom: 0px;">Good {{sunEra()}} [[prefix]] {{'[[name]]'.split()[-1]}}.</h1>-->
                </div>


                <div id="announcements" class="widget">
                    <h1>Announcements{{sp(2)}}–{{sp(2)}}{{ISOWEEKDAYNAMES[now().isoweekday()]}} {{getDate()}}</h1>
                    <hr>
                    [[announcements]]
                </div>
                <div id="snack-poll" class="widget">
                    <h1 id="snack-poll-title">Snack Poll</h1>
                    <hr><!--action="submit-poll" method="POST"-->
                    <form class="snack-poll">
                        <div class="poll-options" id="poll-options">
                            <input type="radio" name="monday" value="op1" id="op1"><label for="op1">Churros</label><br>
                            <input type="radio" name="monday" value="op2" id="op2"><label for="op2">Fruit Roll Ups</label><br>
                            <input type="radio" name="monday" value="op3" id="op3"><label for="op3">Cereal</label><br>
                        </div>
                        <div class="day-label-container"><div class="snack-poll-day-label" id="question-container">Monday</div></div>
                        <div class="button-wrapper">
                            <input id="poll-back-button" type="button" value="⇐" class="movement-arrow yellow-border" style="margin-right: 5%" disabled onclick="pollLastQuestion()">
                            <input id="poll-submit-button" type="submit" value="Submit" class="submit yellow-border" disabled>
                            <input id="poll-next-button" type="button" value="⇒" class="movement-arrow yellow-border"  style="margin-left: 5%" disabled onclick="pollNextQuestion()">
                        </div>
                    </form>
                </div>
                <div id="schedule-container" class="widget" style="[[no_school]]">
                    <center><span id="sdaymarker">[[classday]]</span></center>
                    <div id="periods">
                        [[periods]]
                    </div>
                    <div style="width: 100%; bottom: 20px; position: absolute;">
                        <center>
                            <input type="button" value="⇐" class="movement-arrow yellow-border" style="margin-right: 2%" id="slast" onclick="lastScheduleDay()">
                            <span id="sdatemarker">05/21/2019</span>
                            <input type="button" value="⇒" class="movement-arrow yellow-border" style="margin-left: 2%" id="snext" onclick="nextScheduleDay()">
                        </center>
                    </div>
                </div>
                <div id="class-info" class="widget" style="[[no_school]]">
                    <h2 onclick="nextClassDefaultClick()">[[next_class_info]]</h2>
                    <hr>
                    <div id="info">
                        <div id="meta-container" onclick="nextClassDefaultClick()">
                            [[next_class_meta]]
                        </div>
                        <div id="assignments">
                            <h3 onclick="nextClassDefaultClick()">Assignments Due This Week</h3>
                            <ul>
                                [[assignments]]
                            </ul>
                        </div>
                    </div>
                </div>
                <div id="sagemenu" class="widget" style="[[no_school]]">
                    <h1>Today's Lunch</h1>
                    <hr>
                    <div id="menuitems">
                        [[menu]]
                    </div>
                    <div style="position: absolute; bottom: 0; width: 100%; margin: 0; margin-left: -10px; padding: 0">
                        <center>
                            <div id="allergens">
                                <h4>Dietary Information</h4>
                                [[allergens]]
                            </div>
                        </center>
                    </div>

                </div>
                <div id="maamad-info" class="widget" style="[[no_school]]">
                    <h1>Ma'amad</h1>
                    <hr>
                    [[maamads]]
                </div>
                <br>
                <div id="links-wrapper">
                    <center>
                        <div id="links">
                            <h4>Direct Resources:</h4>
                            <a target="blank" href="http://www.sagedining.com/menus/emeryweiner">Menu</a> | 
                            <a target="blank" href="https://emeryweiner.myschoolapp.com/app/student#studentmyday/assignment-center">Assignments</a> | 
                            <a target="blank" href="https://emeryweiner.myschoolapp.com/app/student#studentmyday/schedule">Schedule</a> | 
                            <a target="blank" href="https://outlook.office.com/owa/?realm=emeryweiner.org">Outlook</a>
                        </div>
                    </center>
                </div>
            </div>
        </center>
        <script>
            let currentDayElem = document.getElementById('sdatemarker');
            let currentDayNumElem = document.getElementById('sdaymarker');
            let arrowBack = document.getElementById('slast');
            let arrowNext = document.getElementById('snext');
            let periodsDiv = document.getElementById('periods');
            let scheduleDiv = document.getElementById('schedule-container');
            let menuDiv = document.getElementById('sagemenu');
            let menuItemsDiv = document.getElementById('menuitems');
            let allergenDiv = document.getElementById('allergens');
            let allergenElems = Array.prototype.slice.call(allergenDiv.getElementsByTagName('p'));
            let maamadDiv = document.getElementById('maamad-info');
            let classInfoDiv = document.getElementById('class-info');

            let classInfoName = document.getElementById('classname');
            let classInfoTime = document.getElementById('start-end');
            let classInfoTeacher = document.getElementById('teacher');
            let classInfoEmail = document.getElementById('teacher-email');
            let nextClassDefault = [classInfoName.innerHTML, classInfoTime.innerHTML, classInfoTeacher.innerHTML, classInfoEmail.innerHTML];
        
            let allergensDefault = allergenElems.map(function(p){return p.innerHTML});

            let pollTitleElem = document.getElementById("snack-poll-title");
            let pollOptionsElem = document.getElementById("poll-options");
            let pollNextButton = document.getElementById("poll-next-button");
            let pollSubmitButton = document.getElementById("poll-submit-button");
            let pollBackButton = document.getElementById("poll-back-button");
            let pollQuestionElem = document.getElementById("question-container");

            function nextClassDefaultClick(){
                classInfoName.innerHTML = nextClassDefault[0];
                classInfoTime.innerHTML = nextClassDefault[1];
                classInfoTeacher.innerHTML = nextClassDefault[2];
                classInfoEmail.innerHTML = nextClassDefault[3];
                revertStyle(greened);
            };

            function allergensDefaultHover(){
                allergenElems.forEach(function(p, i, arr){p.innerHTML = allergensDefault[i]}); //"<p>Food will contain {0}.</p><p>Food may also contain {1}.</p><p>{2}</p>"
            }
        </script>
        {{js('data.js')}}
    </body>
</html>